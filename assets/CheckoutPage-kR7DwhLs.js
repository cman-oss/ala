import{l as oe,m as Le,h as l,s as _e,r as C,j as n,C as F,n as W,o as M,k as D,p as ie,B as O,q as Ie,t as ce,v as Ue,w as Be,x as H}from"./index-CnbaDhrs.js";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=oe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var ue={exports:{}},We="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Me=We,De=Me;function de(){}function pe(){}pe.resetWarningCache=de;var ze=function(){function r(s,a,i,c,u,o){if(o!==De){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:pe,resetWarningCache:de};return t.PropTypes=t,t};ue.exports=ze();var qe=ue.exports;const d=Le(qe);function X(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,s)}return t}function Q(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?X(Object(t),!0).forEach(function(s){fe(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function B(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(e){return typeof e}:B=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(r)}function fe(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function me(r,e){return Ye(r)||$e(r,e)||Ve(r,e)||Ge()}function Ye(r){if(Array.isArray(r))return r}function $e(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var s=[],a=!0,i=!1,c,u;try{for(t=t.call(r);!(a=(c=t.next()).done)&&(s.push(c.value),!(e&&s.length===e));a=!0);}catch(o){i=!0,u=o}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw u}}return s}}function Ve(r,e){if(r){if(typeof r=="string")return Z(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Z(r,e)}}function Z(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,s=new Array(e);t<e;t++)s[t]=r[t];return s}function Ge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=function(e,t,s){var a=!!s,i=l.useRef(s);l.useEffect(function(){i.current=s},[s]),l.useEffect(function(){if(!a||!e)return function(){};var c=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,c),function(){e.off(t,c)}},[a,t,e,i])},V=function(e){var t=l.useRef(e);return l.useEffect(function(){t.current=e},[e]),t.current},w=function(e){return e!==null&&B(e)==="object"},Je=function(e){return w(e)&&typeof e.then=="function"},Ke=function(e){return w(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},ee="[object Object]",He=function r(e,t){if(!w(e)||!w(t))return e===t;var s=Array.isArray(e),a=Array.isArray(t);if(s!==a)return!1;var i=Object.prototype.toString.call(e)===ee,c=Object.prototype.toString.call(t)===ee;if(i!==c)return!1;if(!i&&!s)return e===t;var u=Object.keys(e),o=Object.keys(t);if(u.length!==o.length)return!1;for(var h={},v=0;v<u.length;v+=1)h[u[v]]=!0;for(var g=0;g<o.length;g+=1)h[o[g]]=!0;var p=Object.keys(h);if(p.length!==u.length)return!1;var b=e,k=t,x=function(T){return r(b[T],k[T])};return p.every(x)},he=function(e,t,s){return w(e)?Object.keys(e).reduce(function(a,i){var c=!w(t)||!He(e[i],t[i]);return s.includes(i)?(c&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),a):c?Q(Q({},a||{}),{},fe({},i,e[i])):a},null):null},ve="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",te=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(e===null||Ke(e))return e;throw new Error(t)},Xe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(Je(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(a){return te(a,t)})};var s=te(e,t);return s===null?{tag:"empty"}:{tag:"sync",stripe:s}},Qe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"3.3.0"}),e.registerAppInfo({name:"react-stripe-js",version:"3.3.0",url:"https://stripe.com/docs/stripe-js/react"}))},z=l.createContext(null);z.displayName="ElementsContext";var xe=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ye=function(e){var t=e.stripe,s=e.options,a=e.children,i=l.useMemo(function(){return Xe(t)},[t]),c=l.useState(function(){return{stripe:i.tag==="sync"?i.stripe:null,elements:i.tag==="sync"?i.stripe.elements(s):null}}),u=me(c,2),o=u[0],h=u[1];l.useEffect(function(){var p=!0,b=function(x){h(function(P){return P.stripe?P:{stripe:x,elements:x.elements(s)}})};return i.tag==="async"&&!o.stripe?i.stripePromise.then(function(k){k&&p&&b(k)}):i.tag==="sync"&&!o.stripe&&b(i.stripe),function(){p=!1}},[i,o,s]);var v=V(t);l.useEffect(function(){v!==null&&v!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[v,t]);var g=V(s);return l.useEffect(function(){if(o.elements){var p=he(s,g,["clientSecret","fonts"]);p&&o.elements.update(p)}},[s,g,o.elements]),l.useEffect(function(){Qe(o.stripe)},[o.stripe]),l.createElement(z.Provider,{value:o},a)};ye.propTypes={stripe:d.any,options:d.object};var Ze=function(e){var t=l.useContext(z);return xe(t,e)},et=function(){var e=Ze("calls useElements()"),t=e.elements;return t};d.func.isRequired;var ge=l.createContext(null);ge.displayName="CheckoutSdkContext";var tt=function(e,t){if(!e)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CheckoutProvider> provider."));return e},rt=l.createContext(null);rt.displayName="CheckoutContext";d.any,d.shape({clientSecret:d.string.isRequired,elementsOptions:d.object}).isRequired;var G=function(e){var t=l.useContext(ge),s=l.useContext(z);if(t&&s)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t?tt(t,e):xe(s,e)},nt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},f=function(e,t){var s="".concat(nt(e),"Element"),a=function(o){var h=o.id,v=o.className,g=o.options,p=g===void 0?{}:g,b=o.onBlur,k=o.onFocus,x=o.onReady,P=o.onChange,T=o.onEscape,be=o.onClick,Ee=o.onLoadError,ke=o.onLoaderStart,we=o.onNetworksChange,Pe=o.onConfirm,Ne=o.onCancel,Re=o.onShippingAddressChange,Oe=o.onShippingRateChange,A=G("mounts <".concat(s,">")),L="elements"in A?A.elements:null,_="checkoutSdk"in A?A.checkoutSdk:null,Te=l.useState(null),J=me(Te,2),y=J[0],Ae=J[1],E=l.useRef(null),q=l.useRef(null);j(y,"blur",b),j(y,"focus",k),j(y,"escape",T),j(y,"click",be),j(y,"loaderror",Ee),j(y,"loaderstart",ke),j(y,"networkschange",we),j(y,"confirm",Pe),j(y,"cancel",Ne),j(y,"shippingaddresschange",Re),j(y,"shippingratechange",Oe),j(y,"change",P);var Y;x&&(e==="expressCheckout"?Y=x:Y=function(){x(y)}),j(y,"ready",Y),l.useLayoutEffect(function(){if(E.current===null&&q.current!==null&&(L||_)){var S=null;_?S=_.createElement(e,p):L&&(S=L.create(e,p)),E.current=S,Ae(S),S&&S.mount(q.current)}},[L,_,p]);var K=V(p);return l.useEffect(function(){if(E.current){var S=he(p,K,["paymentRequest"]);S&&"update"in E.current&&E.current.update(S)}},[p,K]),l.useLayoutEffect(function(){return function(){if(E.current&&typeof E.current.destroy=="function")try{E.current.destroy(),E.current=null}catch{}}},[]),l.createElement("div",{id:h,className:v,ref:q})},i=function(o){G("mounts <".concat(s,">"));var h=o.id,v=o.className;return l.createElement("div",{id:h,className:v})},c=t?i:a;return c.propTypes={id:d.string,className:d.string,onChange:d.func,onBlur:d.func,onFocus:d.func,onReady:d.func,onEscape:d.func,onClick:d.func,onLoadError:d.func,onLoaderStart:d.func,onNetworksChange:d.func,onConfirm:d.func,onCancel:d.func,onShippingAddressChange:d.func,onShippingRateChange:d.func,options:d.object},c.displayName=s,c.__elementType=e,c},m=typeof window>"u",st=l.createContext(null);st.displayName="EmbeddedCheckoutProviderContext";var at=function(){var e=G("calls useStripe()"),t=e.stripe;return t};f("auBankAccount",m);var re=f("card",m);f("cardNumber",m);f("cardExpiry",m);f("cardCvc",m);f("fpxBank",m);f("iban",m);f("idealBank",m);f("p24Bank",m);f("epsBank",m);f("payment",m);f("expressCheckout",m);f("currencySelector",m);f("paymentRequestButton",m);f("linkAuthentication",m);f("address",m);f("shippingAddress",m);f("paymentMethodMessaging",m);f("affirmMessage",m);f("afterpayClearpayMessage",m);var ot="v3",it=function(e){return e===3?"v3":e},je="https://js.stripe.com",ct="".concat(je,"/v3"),lt=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ut=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,ne="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",dt=function(e){return lt.test(e)||ut.test(e)},pt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(je,'"]')),t=0;t<e.length;t++){var s=e[t];if(dt(s.src))return s}return null},se=function(e){var t="",s=document.createElement("script");s.src="".concat(ct).concat(t);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(s),s},ft=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"5.10.0",startTime:t})},N=null,I=null,U=null,mt=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},ht=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},vt=function(e){return N!==null?N:(N=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ne),window.Stripe){t(window.Stripe);return}try{var a=pt();if(a&&e)console.warn(ne);else if(!a)a=se(e);else if(a&&U!==null&&I!==null){var i;a.removeEventListener("load",U),a.removeEventListener("error",I),(i=a.parentNode)===null||i===void 0||i.removeChild(a),a=se(e)}U=ht(t,s),I=mt(s),a.addEventListener("load",U),a.addEventListener("error",I)}catch(c){s(c);return}}),N.catch(function(t){return N=null,Promise.reject(t)}))},xt=function(e,t,s){if(e===null)return null;var a=t[0],i=a.match(/^pk_test/),c=it(e.version),u=ot;i&&c!==u&&console.warn("Stripe.js@".concat(c," was loaded on the page, but @stripe/stripe-js@").concat("5.10.0"," expected Stripe.js@").concat(u,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,t);return ft(o,s),o},R,Se=!1,Ce=function(){return R||(R=vt(null).catch(function(e){return R=null,Promise.reject(e)}),R)};Promise.resolve().then(function(){return Ce()}).catch(function(r){Se||console.warn(r)});var yt=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];Se=!0;var a=Date.now();return Ce().then(function(i){return xt(i,t,a)})},gt={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const jt=yt(gt.VITE_STRIPE_PUBLISHABLE_KEY||"");async function St(r,e){try{const{data:t,error:s}=await _e.functions.invoke("create-checkout-session",{body:{priceId:r,userId:e}});if(s)throw s;return t}catch(t){throw console.error("Error creating checkout session:",t),t}}const Ct=({priceId:r,onSuccess:e,onCancel:t})=>{const s=at(),a=et(),[i,c]=C.useState(null),[u,o]=C.useState(!1),h=async v=>{if(v.preventDefault(),!s||!a)return;o(!0),c(null);const g=a.getElement(re);if(!g){o(!1),c("Card element not found");return}const{error:p,paymentMethod:b}=await s.createPaymentMethod({type:"card",card:g});if(p){c(p.message||"An error occurred with your payment"),o(!1);return}setTimeout(()=>{o(!1),e&&e()},2e3)};return n.jsxs(F,{className:"w-full max-w-md mx-auto",children:[n.jsx(W,{children:n.jsx(M,{children:"Complete Your Subscription"})}),n.jsxs("form",{onSubmit:h,children:[n.jsx(D,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{htmlFor:"card-element",className:"block text-sm font-medium",children:"Card Details"}),n.jsx("div",{className:"p-3 border rounded-md",children:n.jsx(re,{id:"card-element",options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})})]}),i&&n.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:i})]})}),n.jsxs(ie,{className:"flex justify-between",children:[n.jsx(O,{type:"button",variant:"outline",onClick:t,disabled:u,children:"Cancel"}),n.jsx(O,{type:"submit",disabled:!s||u,children:u?n.jsxs(n.Fragment,{children:[n.jsx(le,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Subscribe Now"})]})]})]})},bt=({tier:r,onContinue:e})=>n.jsxs(F,{className:"w-full max-w-md mx-auto text-center",children:[n.jsxs(W,{children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"rounded-full bg-green-100 p-3",children:n.jsx(Ie,{className:"h-8 w-8 text-green-600"})})}),n.jsx(M,{className:"text-2xl",children:"Payment Successful!"})]}),n.jsxs(D,{children:[n.jsxs("p",{className:"mb-4",children:["Thank you for subscribing to our ",r," plan. Your account has been upgraded and you now have access to all the features included in your subscription."]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:[n.jsxs("h3",{className:"font-medium mb-2",children:["Your ",r," Plan Includes:"]}),r==="Professional"?n.jsxs("ul",{className:"text-sm text-left list-disc pl-5 space-y-1",children:[n.jsx("li",{children:"15 projects"}),n.jsx("li",{children:"Advanced synthesis algorithms"}),n.jsx("li",{children:"Enhanced visualization tools"}),n.jsx("li",{children:"Multiple export formats"}),n.jsx("li",{children:"Reaction optimization suggestions"})]}):r==="Enterprise"?n.jsxs("ul",{className:"text-sm text-left list-disc pl-5 space-y-1",children:[n.jsx("li",{children:"Unlimited projects"}),n.jsx("li",{children:"Premium synthesis algorithms"}),n.jsx("li",{children:"Advanced visualization and modeling"}),n.jsx("li",{children:"All export formats"}),n.jsx("li",{children:"Team collaboration features"}),n.jsx("li",{children:"Priority support"})]}):n.jsx("p",{className:"text-sm",children:"Basic features included in your plan"})]})]}),n.jsx(ie,{children:n.jsx(O,{onClick:e,className:"w-full",children:"Continue to Dashboard"})})]}),Et=({priceId:r,tier:e,onSuccess:t,onCancel:s})=>{const{user:a}=ce(),[i,c]=C.useState(!0),[u,o]=C.useState(null),[h,v]=C.useState(!1),[g,p]=C.useState("");C.useEffect(()=>{if(!a)return;(async()=>{try{c(!0);const x=await St(r,a.id);x.url?window.location.href=x.url:x.clientSecret&&(p(x.clientSecret),c(!1))}catch(x){console.error("Error initializing checkout:",x),o("Failed to initialize checkout. Please try again."),c(!1)}})()},[r,a]);const b=()=>{v(!0),t&&setTimeout(t,500)};return i?n.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[n.jsx(le,{className:"h-8 w-8 animate-spin text-blue-600 mb-4"}),n.jsx("p",{children:"Initializing checkout..."})]}):u?n.jsxs("div",{className:"text-center p-8",children:[n.jsx("p",{className:"text-red-600 mb-4",children:u}),n.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Go Back"})]}):h?n.jsx(bt,{tier:e,onContinue:t||(()=>{})}):n.jsx(ye,{stripe:jt,children:n.jsx(Ct,{priceId:r,onSuccess:b,onCancel:s})})},ae={free:{id:"price_free",amount:0},pro:{id:"price_pro",amount:1999},enterprise:{id:"price_enterprise",amount:4999}},$={free:"Free",pro:"Professional",enterprise:"Enterprise"},wt=()=>{const[r]=Ue(),e=Be(),{user:t,loading:s}=ce(),[a,i]=C.useState("pro");C.useEffect(()=>{const o=r.get("tier");o&&["free","pro","enterprise"].includes(o)&&i(o)},[r]),C.useEffect(()=>{!s&&!t&&e("/login?redirect=/checkout")},[t,s,e]);const c=()=>{e("/dashboard")},u=()=>{e("/subscription")};return s||!t?n.jsx("div",{className:"container mx-auto py-10 px-4",children:n.jsx("div",{className:"text-center",children:n.jsx("p",{children:"Loading..."})})}):a==="free"?n.jsx("div",{className:"container mx-auto py-10 px-4",children:n.jsxs(F,{className:"max-w-md mx-auto",children:[n.jsxs(W,{children:[n.jsx(M,{children:"Free Plan Selected"}),n.jsx(H,{children:"You've selected the Free plan which doesn't require payment."})]}),n.jsxs(D,{children:[n.jsx("p",{className:"mb-4",children:"Your account is already on the Free plan with access to:"}),n.jsxs("ul",{className:"list-disc pl-5 mb-6 space-y-1",children:[n.jsx("li",{children:"3 projects"}),n.jsx("li",{children:"Basic synthesis pathways"}),n.jsx("li",{children:"Standard visualization"}),n.jsx("li",{children:"PNG exports"})]}),n.jsx(O,{onClick:()=>e("/dashboard"),className:"w-full",children:"Go to Dashboard"})]})]})}):n.jsx("div",{className:"container mx-auto py-10 px-4",children:n.jsxs("div",{className:"max-w-3xl mx-auto",children:[n.jsxs(O,{variant:"ghost",className:"mb-6",onClick:()=>e("/subscription"),children:[n.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Back to Plans"]}),n.jsxs(F,{className:"mb-8",children:[n.jsxs(W,{children:[n.jsxs(M,{children:["Checkout - ",$[a]," Plan"]}),n.jsx(H,{children:"Complete your subscription to access premium features"})]}),n.jsxs(D,{children:[n.jsxs("div",{className:"flex justify-between items-center mb-6 p-4 bg-gray-50 rounded-md",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"font-medium",children:[$[a]," Plan"]}),n.jsx("p",{className:"text-sm text-gray-500",children:"Monthly subscription"})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-xl font-bold",children:["$",(ae[a].amount/100).toFixed(2)]}),n.jsx("p",{className:"text-xs text-gray-500",children:"per month"})]})]}),n.jsx(Et,{priceId:ae[a].id,tier:$[a],onSuccess:c,onCancel:u})]})]})]})})};export{wt as default};
